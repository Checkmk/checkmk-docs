// -*- coding: utf-8 -*-
include::global_attr.adoc[]

[#folder_network_scan]
== Netzwerk-Scan für Ordner durchführen

{CMK} bietet die Möglichkeit ihr Netzwerk - oder auch nur Teile davon - automatisch und regelmäßig nach (neuen) Hosts zu durchsuchen.
Die Funktion lässt sich auf Ebene der Ordner in der Verwaltung der Hosts einrichten.
Öffnen Sie zuerst [.guihint]#Setup > Hosts > Hosts#, navigieren Sie anschließend in einen beliebigen Ordner oder verbleiben Sie im Ordner [.guihint]#Main#.
Über das Menü [.guihint]#Folder > Properties# finden Sie den Abschnitt [.guihint]#Network Scan#.

image::wato_host_network_scan_new.png[alt="Deaktivierter Abschnitt _Network Scan_ in den Eigenschaften eines Ordners".]

Aktivieren Sie den Netzwerk-Scan über die entsprechende Checkbox.

image::wato_host_network_scan_activated.png[alt="Aktivierter aber unkonfigurieter Abschnitt _Network Scan_".]

Legen Sie anschließend IP-Adressen fest, welche {CMK} für Sie automatisch überwachen soll.
Für diese Festlegung haben Sie die Wahl zwischen einzelnen expliziten IP-Adressen, IP-Bereichen und ganzen Netzwerken.
Wir empfehlen die Adressbereiche nicht zu groß zu wählen, da es ansonsten zu sehr langen Laufzeiten des Netzwerk-Scans kommen kann.
Bei der Wahl einer Netzmaske empfehlen wir die /21 nicht zu unterschreiten.
Für die Festlegung über [.guihint]#IP-Range# sollte Sie pro Folder also nicht viel mehr als 2000 IP-Adressen konfigurieren.
Dies kann natürlich nur eine grobe Empfehlung sein, da ihr (Firmen-)Netzwerk womöglich mit größeren Adressbereichen problemlos klarkommt.

Über die folgende Option [.guihint]#IP ranges to exclude# können Sie aus dem oberhalb konfigurierten Adressbereich Teile ausnehmen. Die Option bietet sich auch an, um bereits bekannte und überwachte Hosts bzw. IP-Adressen aus dem Netzwerk-Scan auszuschließen. So können Sie verhindern, dass Dubletten von Hosts angelegt werden.

Mit den folgenden beiden Optionen [.guihint]#Scan interval# und [.guihint]#Time allowed# können Sie festlegen, wie häufig und wann Checkmk den Netzwerk-Scan durchführen soll. Hier sollten Sie nur bedenken, dass zu häufiges Pingen großer Zahlen von IP-Adressen selbst im eigenen Netzwerk eventuell als unfreundlicher Akt angesehen werden könnte.
Zurückhaltende Werte beziehungsweise eine entsprechende Absprache mit Ihren Netzwerk- und Firewall-Administratoren ist hier sicherlich hilfreich.

Mit die wichtigste Überlegung bei der Einrichtung des Netzwerk-Scans ist, wie Sie mit gefundenen Hosts umgehen wollen. Hierbei fällt der Option [.guihint]#Set criticality host tag# eine zentrale Rolle zu.
Per Standard ist hier [.guihint]#Do not monitor this host# ausgewählt.
Dies bedeutet also, dass Hosts erst mal nur gefunden und in die xref:wato_hosts#[Host-Verwaltung] aufgenommen werden.
Ein Monitoring findet so also nicht unmittelbar statt.
Ein Ansatz könnte hier sein, die so gefundenen Hosts, mit Hilfe der Funktion [.guihint]#Move this host to another folder#, manuell in Ihre bestehende Host-Struktur zu überführen.
Wählen Sie hier als Host-Merkmal [.guihint]#Productive system# aus, werden die gefundenen Hosts - bei entsprechender Konfiguration der xref:wato_services#discovery_auto[Periodic service Discovery] - auch direkt ins Monitoring aufgenommen.
Bei großen Adressbereichen sollte Sie sich sehr sicher sein, dass Ihr DNS und die zugehörige Reverse-Zone sehr gut gepflegt ist.
Andernfalls werden Sie womöglich viele Hosts über den Netzwerk-Scan finden, welche unter anderem Namen bereits durch Checkmk überwacht werden.

Bitte beachten Sie bei der Verwendung des Netzwerk-Scan auch die folgenden grundsätzlichen Überlegungen:

* Der Scan läuft über einen Ping ab. Das bedeutet auch, dass SNMP- bzw. UDP-Geräte nicht gefunden werden können.
* Bei neuen Windows-Hosts ist ohne eine entsprechende Konfiguration durch bspw. Group-Policies der sogenannte _Echo request_ in der Firewall deaktiviert. Solche Windows-Hosts werden dem Scan also nicht antworten und somit auch nicht gefunden.
* Halten Sie die zu durchsuchenden Adressbereiche eher klein.
* {CMK} kann Ihnen zu den gefundenen Hosts nur dann saubere Daten liefern, wenn Ihr Netzwerk entsprechend konfiguriert ist. Falsche Pointer im DNS und ein veraltetes Reverse-DNS können zu Dubletten führen.