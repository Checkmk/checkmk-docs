// -*- coding: utf-8 -*-
// IGNORE crontab liveproxyd npcd ui
// SKIPCOMMITS
include::global_attr.adoc[]
= Instanzdienste
:revdate: draft
:title: Checkmk unter der Haube - Dienste einer {CMK}-Instanz im Überblick
:description: Für den Betrieb einer {CMK}-Instanz werden viele einzelne Dienste benötigt, die wir hier vorstellen.


{related-start}
xref:intro_setup#[{CMK} aufsetzen]
xref:omd_basics#[Instanzen mit OMD verwalten]
xref:wato_rules#[Regeln]
{related-end}

[IMPORTANT]
====
Dies ist ein früher Artikelentwurf -- Work in Progress! 
====

[#intro]
== Einleitung
Eine {CMK}-Instanz benötigt allerlei Dienste, allem voran den {CMK} Monitoring Core (CMC), aber genauso einen Apache-Webserver für die Web-Oberfläche, Cron für die Planung von Aufgaben und so weiter.
All diese Dienste sehen Sie beim Start einer Instanz mittels `omd start' im Terminal -- einige in allen Editionen und standardmäßig, andere nur in bestimmten Editionen und/oder wenn entsprechende Funktionen aktiviert sind.
Der Befehl `omd status` auf eine kommerzielle Edition könnte etwa zu folgender Ausgabe führen:

[{shell}]
----
{c-omd} omd status

jaeger:             [green]#running#
agent-receiver:     [green]#running#
mkeventd:           [green]#running#
liveproxyd:         [green]#running#
mknotifyd:          [green]#running#
rrdcached:          [green]#running#
redis:              [green]#running#
automation-helper:  [green]#running#
ui-job-scheduler:   [green]#running#
cmc:                [green]#running#
apache:             [green]#running#
dcd:                [green]#running#
stunnel:            [green]#running#
xinetd:             [green]#running#
crontab:            [green]#running#
rabbitmq:           [green]#running#
---------------------------
Overall state:      [green]#running#
----

Die folgende Tabelle gibt einen kurzen Überblick und zeigt zu jedem Dienst

- den angezeigten Prozessnamen,
- ob er in der Open-Source-Edition und/oder in den kommerziellen existiert,
- ob er standardmäßig, ohne explizite Konfiguration existiert sowie
- eine kurze Beschreibung, was der Dienst überhaupt erledigt.

Die meisten Dienste werden in den zugehörigen verlinkten Artikeln genauer erklärt, andere sind weitgehend selbsterklärend (etwa der Apache-Dienst).
Auf einige weitere Dienste, die lediglich im Hintergrund ihre Arbeit verrichten, gehen wir separat ein.

[#siteservices]
== Instanzdienste - Tabelle

[cols="~,~,~,~,40",options="header"]
|===
|Dienst |{CRE} |kommerzielle Editionen |Standard |Beschreibung
|agent-receiver |Ja |Ja |Ja |Endpunkt für die xref:wato_monitoringagents#agents[Kommunikation mit dem Agenten]
|apache |Ja |Ja |Ja |Webserver
|automation-helper |Ja |Ja |Ja |Hilfsdienst zur Performance-Steigerung bei GUI- und Rest-API-Anfragen
|cmc |Nein |Ja |Ja |xref:cmc#[{CMK} Micro Core] -- Monitoring-Kern in den kommerziellen Editionen
|crontab |Ja |Ja |Ja |crontab-Datei für interne Aufgabenplanung
|dcd |Nein |Ja |Ja |xref:dcd#[Dynamic Configuration Daemon] zur automatischen Verwaltung flüchtiger Hosts (etwa Container)
|jaeger  |Nein |Ja |Nein |Analyse-Werkzeug für Traces, empfangen via OpenTelemetry -- für internes Bug-Fixing (siehe link:https://checkmk.com/werk/16565[Werk 16565])
|liveproxyd |Ja |Ja |Ja |Schnittstelle für xref:livestatus#[Statusdaten]
|mkeventd |Ja |Ja |Ja |Dienst zur Verarbeitung von xref:ec#[Ereignissen]
|mknotifyd |Nein |Ja |Nein |xref:notifications#[Benachrichtigungs-Spooler] für asynchrone Zustellung und verteilte Umgebungen
|nagios |Ja |Nein |Ja |Monitoring-Kern der {CRE} und alter Installationen kommerzieller Editionen (kann xref:cmc_migration#[umgestellt] werden)
|npcd |Ja |Nein |Ja |link:https://linux.die.net/man/8/npcd[Nagios Performance C Daemon] zur Verarbeitung von Nagios-Performance-Daten in der {CRE}
|RabbitMQ |Nein |Ja |Nein |Message-Broker
|redis |Ja |Ja |Ja |Im-Memory-Datenbank als Zwischenspeicher
|rrdcached |Ja |Ja |Ja |xref:graphing#rrds[RRD-Cache-Daemon] für die Zwischenspeicherung von Messwerten
|stunnel |Ja |Ja |Nein |Baut einen xref:livestatus#[Tunnel] von einem lokalen, unverschlüsselten Livestatus-Port zu einem entfernten verschlüsselten auf
|ui-job-scheduler |Nein |Ja |Nein |Scheduler für asynchrone Aufgaben der Web-Oberfläche
|xinetd |Ja |Ja |Nein |Dienst zur Bereitstellung der Agentenausgabe
|===

== Jaeger
== RabbitMQ
== ui-job-scheduler


