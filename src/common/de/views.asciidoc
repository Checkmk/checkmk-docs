// -*- coding: utf-8 -*-
// IGNORE % Logfile checkboxes ➤
// SKIPCOMMITS 2025-07-23
include::global_attr.adoc[]
= Ansichten von Hosts und Services (Views)
:revdate: 2025-02-18
:title: Ansichten von Hosts und Services (Views)
:description: Tabellenansichten sind in {CMK} sehr mächtig und können indiviuell erstellt oder angepasst werden. Wie Sie Ansichten effektiv nutzen, erfahren Sie hier.

{related-start}
xref:user_interface#[Die Benutzeroberfläche]
xref:dashboards#[Dashboards]
xref:graphing#[Messwerte und Graphing]
{related-end}


== Einleitung

Die wichtigste Aufgabe der xref:user_interface#[Benutzeroberfläche] von {CMK} ist das Anzeigen des aktuellen Zustands von Hosts und Services.
Dies geschieht größtenteils in tabellarischen _Ansichten,_ welche in der englischen Oberfläche mit _Views_ bezeichnet werden.
Damit das tägliche Arbeiten mit {CMK} so effizient wie möglich abläuft, bieten diese Tabellenansichten zahlreiche nützliche Funktionen und Sie können sie an Ihre Anforderungen anpassen.

Wir unterscheiden zwischen *globalen* Tabellenansichten und solchen, die einen *Kontext* benötigen.
Globale Tabellenansichten können immer direkt aufgerufen werden.
Ein Beispiel ist die Liste aller aktuellen Service-Probleme.
Einen Kontext benötigt z.B. die Tabellenansicht [.guihint]#Status of Host ...# -- nämlich die Angabe desjenigen Hosts, dessen Zustand angezeigt werden soll.
Solche Tabellenansichten können nur in Situationen aufgerufen werden, in denen es um einen bestimmten Host geht.


=== Globale Tabellenansichten

Die globalen Tabellenansichten erreichen Sie am einfachsten über das [.guihint]#Monitor#-Menü.

ifdef::onprem[]
.Das [.guihint]#Monitor#-Menü von {RE} im Show-less-Modus
image::monitor_menu_less.png[alt="Monitor-Menü von {RE} im Show-less-Modus."]
endif::[]
ifdef::saas[]
.Das [.guihint]#Monitor#-Menü im Show-less-Modus
image::monitor_menu_less_saas.png[alt="Monitor-Menü im Show-less-Modus."]
endif::[]

Alternativ können Sie auch die xref:glossar#snapin[Snapins] [.guihint]#Overview# und [.guihint]#Views# nutzen.
Im [.guihint]#Overview# ist jede der Zahlen anklickbar und bringt Sie zu einer globalen Tabellenansicht, die die jeweils gezählten Hosts oder Services einzeln auflistet.

image::views_snapin_overview.png[alt="Das Snapin 'Overview' der Seitenleiste.",width=50%]

Im Snapin [.guihint]#Views# sind alle globalen Tabellenansichten erreichbar -- gruppiert nach Thema (_topic_).
Zudem finden Sie einige Einträge, die eigentlich keine [.guihint]#Views# sind -- wie z.B. die xref:glossar#dashboard[Dashboards], welche unter dem Thema [.guihint]#Overview# einsortiert sind.
Dashboards können aber Views _enthalten._

image::views_snapin_views.png[alt="Das Snapin 'Views' der Seitenleiste.",width=50%]

Von einer globalen Tabellenansicht aus gelangen Sie zu den Einzelheiten eines bestimmten Hosts oder Services in einem weiteren Schritt.
Die Namen von Hosts und Services und auch andere Spalten in den einzelnen Zellen sind anklickbar &hellip; :

image::views_all_hosts.png[alt="Die Ansicht 'All hosts'."]

&hellip; und bringen Sie zu (kontext-abhängigen) Detailansichten.


=== Kontext-abhängige Tabellenansichten

In Tabellenansichten, die _einen bestimmten_ Host oder Service betreffen, finden Sie in den Menüs [.guihint]#Host# beziehungsweise [.guihint]#Service# wiederum allerlei Einträge,
die Sie dann zu weiteren Tabellenansichten mit demselben Kontext bringen -- also von demselben Host oder Service.

image::views_context_buttons.png[alt="Ansicht mit geöffnetem Menü 'Service'."]

Sie können Host- und Service-spezifische Tabellenansichten auch über die xref:intro_gui#search_monitor[Suche im Monitor-Menü] erreichen:

image::views_monitor_search.png[alt="Die Suche im Monitor-Menü.",width=60%,align=center]

Ein weiterer Weg zu Detailansichten ist die Schnellsuche mit dem Snapin [.guihint]#Quicksearch# in der Seitenleiste:

image::views_snapin_quicksearch.png[alt="Das Snapin 'Quicksearch' der Seitenleiste.",width=50%]

Zu welcher Tabellenansicht Sie jeweils gelangen, hängt vom Ergebnis der Suche ab.
Wenn die Suche einen Host eindeutig ermittelt, dann gelangen Sie direkt zur Seite [.guihint]#Services of Host ...# dieses Hosts.

image::views_services_of_host.png[alt="Die Ansicht der Services eines Hosts."]

Dort finden Sie dann wieder die Menüeinträge zu den anderen Tabellenansichten des gleichen Hosts.
Ein Klick auf den Namen des Hosts bringt Sie beispielsweise zur Ansicht [.guihint]#Status of Host.#


=== Auswirkung in der Menüleiste

[#menucontext]
Die Unterscheidung zwischen globalen, Host- und Service-spezifischen Tabellenansichten macht sich auch in der Menüleiste bemerkbar.
Immer vorhanden sind die Menüs [.guihint]#Commands, Export, Display# und [.guihint]#Help.#

In globalen Host-Ansichten gibt es zudem das Menü [.guihint]#Hosts# sowie in globalen Service-Ansichten [.guihint]#Services# -- beachten Sie hier den Plural!
Darüber können Sie zum Beispiel die xref:availability#[Verfügbarkeit] aller Hosts oder Services der aktuellen Ansicht aufrufen.

image::views_menu_global.png[alt="Menüleiste der Ansicht 'All hosts'."]

Tabellenansichten eines einzelnen Hosts hingegen, haben die Menüs [.guihint]#Host# und [.guihint]#Services# mit allen Aktionen für den aktuellen Host beziehungsweise für all die Services der aktuellen Ansicht.

image::views_menu_context_host.png[alt="Menüleiste der Ansicht 'Services of Host'."]

Tabellenansichten eines einzelnen Services wiederum haben ebenfalls das Menü [.guihint]#Host#, dazu aber nun im Singular [.guihint]#Service#, mit Aktionen für diesen einen Service.

image::views_menu_context_service.png[alt="Menüleiste der Ansicht eines Services."]


[#using_views]
== Tabellenansichten verwenden

=== Optionen, Filter und Kommandos

Jede Tabellenansicht bietet diverse Optionen, über die Sie diese beeinflussen und Aktionen auslösen können.

[#filter]
[cols="30,~",options="header"]
|===
|Menü |Funktion

|[.guihint]#Commands# |Hier können Sie Kommandos auf den gezeigten Objekten ausführen (z.B. Eintragen von Wartungszeiten).
Die Kommandos sind detailliert in einem xref:commands#[eigenen Artikel] beschrieben.

|[.guihint]#Display > Filter# |Öffnet die Filterleiste am rechten Rand der Hauptseite.
Damit können Sie die gezeigten Daten weiter einschränken.
Sobald Sie einen Filter gesetzt haben, ändert sich das Symbol auf icon:icon_filters_set[alt="Symbol für einen gesetzten Filter."], damit klar ist, dass unter Umständen nicht alle Daten angezeigt werden.
Umgekehrt haben manche Tabellenansichten schon Filter vorbelegt (z.B. die Liste aller Probleme).
Hier können Sie durch Entfernen der Filter wiederum mehr Daten anzeigen lassen.
Änderungen der Filter werden nicht gespeichert, sondern wieder zurückgesetzt, sobald Sie die Ansicht verlassen.

|[.guihint]#Display > Show checkboxes# |Damit schalten Sie Checkboxen ein oder aus.
Mit den Checkboxen können Sie die Kommandos auf ausgewählte Datensätze einschränken.

|[.guihint]#Display > Modify display options > Entries per row# |Legt die Anzahl der Spalten für die Ansicht fest.
Mehrspaltige Tabellenansichten helfen, auf breiten Monitoren den verfügbaren Platz auszunutzen.
Bei Tabellenansichten, die nur einen Datensatz anzeigen, ist diese Einstellung wirkungslos.

|[.guihint]#Display > Modify display options > Refresh interval# |Legt fest, in welchem Intervall die Ansicht neu geladen wird.
Sie können damit das automatische Neuladen auch ganz abschalten.
Beachten Sie, dass es in diesem Fall sein kann, dass Sie über ein inzwischen aufgetretenes Problem nicht informiert werden!

|[.guihint]#Display > Modify display options > Date format# |Änderung des Formats für die Datumsanzeige.

|[.guihint]#Display > Modify display options > Time stamp format# |Zeitstempel können absolut, relativ, gemixt, gemeinsam oder als „Unix Timestamp“ angezeigt werden.
|===


=== Zeit- und Datumsangaben

{CMK} zeigt in seinen Ansichten alle Zeitangaben, die weniger als 24 Stunden in der Vergangenheit oder Zukunft liegen, als relative Angaben -- also z.B. [.guihint]#16 hours.#
Sie können das im Menü über [.guihint]#Display > Modify display options# umschalten und wahlweise nur absolute, nur relative oder beide Werte anzeigen lassen, oder auch den „Unix Timestamp“.
Auch das Datumsformat können Sie in diesem Dialog festlegen.

image::views_time_date.png[alt="Änderung der Darstellungsoptionen."]


=== Sortierung

Die Tabellenansichten können Sie durch ein Klicken auf die Spaltenüberschriften sortieren.
Dabei gibt es drei Zustände einer Spalte, die durch mehrfaches Klicken im Kreis herum der Reihe nach ausgewählt werden:

* Aufsteigend sortieren
* Absteigend sortieren
* Nicht mehr nach dieser Spalte sortieren

Zunächst wird eine Tabellenansicht immer auf eine „natürliche“ Art sortiert, die in der Tabellenansicht selbst festgelegt ist.
Bei den Service-Ansichten ist die Sortierung immer alphabetisch nach dem Namen des Services -- mit der Ausnahme, dass die [.guihint]#Check_MK#-Services immer oben stehen.
Neben dem Service [.guihint]#Check_MK#, der für die Abfrage des Monitoring-Agenten zuständig ist, sind das noch [.guihint]#Check_MK Discovery#, [.guihint]#Check_MK HW/SW Inventory# und gegebenenfalls
[.guihint]#Check_MK Agent#.
Um eine solche Liste nach dem aktuellen Zustand der Services zu sortieren genügt ein Klick auf [.guihint]#State.#

image::views_sort_by_state.png[alt="Sortierung einer Liste nach Spaltenüberschriften."]

Die Sortierung nach der Spalte [.guihint]#Perf-O-Meter# führt manchmal zu überraschenden Ergebnissen.
Das liegt daran, dass die grafische Darstellung der xref:graphing#[Messwerte] teilweise eine prozentuale Zusammenfassung der eigentlichen Werte zeigt.
Die Sortierung geschieht aber nach den absoluten Werten -- und zwar immer nach der _ersten Metrik_, die ein Service ausgibt.


[#export]
=== Export

Sie können die in einer Tabellenansicht gezeigten Daten in verschiedenen Formaten über das Menü [.guihint]#Export# exportieren:

[cols="30,~",options="header"]
|===
|Menüeintrag |Funktion

|[.guihint]#Data > Export CSV# |Als Trennzeichen wird ein Semikolon verwendet.
Die einzelnen Zellen sind in Anführungszeichen eingeschlossen.
In der ersten Zeile sind die internen Kürzel für die einzelnen Spalten eingetragen.

|[.guihint]#Data > Export JSON# |Beim JSON-Export landen die Zellen ebenfalls in Anführungszeichen, getrennt durch Umbrüche und Kommata, umschlossen von eckigen Klammern.

|[.guihint]#Reports > This view as PDF# |
ifdef::onprem[]
Nur in den kommerziellen Editionen:
endif::[]
Hierbei wird ein sogenannter Sofortbericht (_instant report_) erzeugt, der die aktuelle Tabellenansicht in ein PDF-Dokument überführt, abzüglich Icons, Navigation und so weiter.
Das Aussehen können Sie über spezielle Berichtsvorlagen im xref:reporting#[Reporting] anpassen.

|[.guihint]#Reports# |Je nach aktueller Tabellenansicht werden hier weitere PDF-Exporte angeboten, etwa zur Verfügbarkeit, sowie gegebenenfalls individuell erstellte Vorlagen.

|[.guihint]#REST API > Query hosts/services resource# |Ausgabe der xref:rest_api#[REST-API] zur Host-/Service-Auswahl der aktuellen (gefilterten) Tabellenansicht.

|===


[#limit]
=== Das Anzeigelimit

Bei einer größeren Monitoring-Umgebung sind nicht mehr alle Tabellenansichten sinnvoll.
Wenn Sie 50 000 Services überwachen und die Ansicht [.guihint]#All Services# anwählen, würde die Darstellung nicht nur sehr lange brauchen -- sie wäre auch wenig nützlich.

Um den Benutzer in solchen Situationen vor langen Wartezeiten zu schützen und das System nicht durch absurde Datenmengen in die Knie zu zwingen,
sind Tabellenansichten auf die Anzeige von 1000 Einträgen begrenzt.
Bei einer Überschreitung erhalten Sie folgenden Hinweis:

image::views_limit1.png[alt="Hinweis vor der Anzeige einer Ansicht mit mehr als 1000 Einträgen.",width=80%]

Wie Sie sehen, werden Sie darauf hingewiesen, dass die gezeigten Datensätze nicht unbedingt die ersten 1000 gemäß der gewählten Sortierung sind!
Das hat einen technischen Hintergrund.
Die Limitierung wird nämlich bereits an der Quelle der Daten durchgesetzt:
ifdef::onprem[]
in den Monitoring-Kernen der angebundenen Instanzen.
endif::[]
ifdef::saas[]
im Monitoring-Kern der Instanz.
endif::[]
Das ist sehr wichtig:
Denn wenn wir erst eine Million Datensätze 
ifdef::onprem[]
aus Ihrer weltweit verteilten Umgebung zusammensammeln würden, um gleich danach 99,9{nbsp}% der Daten 
endif::[]
ifdef::saas[]
zusammensammeln würden, um gleich danach 99,9{nbsp}% der Daten
endif::[]
wieder wegzuwerfen, dann wäre das Kind ja schon in den Brunnen gefallen.
Die Sortierung übernimmt erst am Ende die Oberfläche -- es geschieht also _nach_ der Limitierung.
Denn die Daten von allen Instanzen müssen ja gemeinsam sortiert werden.

Sofern Sie wirklich der Meinung sind, mehr als 1000 Datensätze sehen zu wollen, können Sie durch einen Klick auf [.guihint]#Repeat query and allow more results# ins nächste Level kommen.
Hier greift eine Begrenzung auf 5000 Datensätze.
Ist diese wieder überschritten, so können Sie _ganz ohne Limit_ fortfahren.
Da dies eine gefährliche Operation sein kann, benötigt sie Administratorrechte.
Sie wurden gewarnt!

image::views_limit2.png[alt="Hinweis vor der Anzeige einer Ansicht mit mehr als 5000 Einträgen.",width=80%]

Sie können die beiden Stufen unter [.guihint]#Global settings > User interface# mit [.guihint]#Soft query limit# und [.guihint]#Hard query limit# anpassen:

image::views_limit3.png[alt="Globale Einstellung zur Änderung der beiden Limits."]


[#edit]
== Ansichten anpassen

=== Grundsätzliches

{CMK} erlaubt Ihnen, die mitgelieferten Tabellenansichten anzupassen und sogar ganz Neue zu erzeugen, welche Sie dann auch in xref:reporting#[Berichte] und xref:glossar#dashboard[Dashboards] einbauen können.
Dabei können Sie bei jeder Tabellenansicht eine Menge verschiedener Aspekte bestimmen:

* *Allgemeine Dinge* wie Titel, Thema, usw.
* Welche *Datenquelle* wird dargestellt (z.B., Hosts, Services, Daten der Business Intelligence (BI) etc.)?
* Welche Auswahl an Datensätzen wird dargestellt (*Filterung*)?
* Welche *Spalten* werden dargestellt?
* Zu welchen anderen Tabellenansichten *verlinken* die Texte in den Spalten?
* Wie wird standardmäßig *sortiert*?
* Gibt es eine *Gruppierung,* und falls ja, wie sieht diese aus?
* Wo und für welche Benutzer soll die Tabellenansicht *sichtbar* sein?
* Welche Art von *Tabellenlayout* soll verwendet werden?

Den Editiermodus für Tabellenansichten erreichen Sie auf zwei Arten:

. Bei einer bestehenden Tabellenansicht über einen Menüeintrag. Hier gibt es vier Varianten, abhängig vom Ursprung der jeweiligen Tabellenansicht:
* [.guihint]#Display > Clone builtin view# -- erstellt einen Klon der mitgelieferten Tabellenansicht.
* [.guihint]#Display > Edit my view# -- öffnet den Bearbeitungsmodus für Ihre selbst erstellte Tabellenansicht.
* [.guihint]#Display > Clone view# -- legt einen Klon der Tabellenansicht eines anderen Benutzers an -- wenn Sie keine Berechtigung zur Bearbeitung fremder Tabellenansichten haben.
* [.guihint]#Display > Edit view of user X# und [.guihint]#Display > Clone view# -- womit Sie wählen können, ob Sie die Tabellenansicht des anderen Benutzers bearbeiten oder stattdessen einen Klon seiner Tabellenansicht erstellen wollen -- wenn Sie die Berechtigung zur Bearbeitung fremder Tabellenansichten haben.
. Im Menü [.guihint]#Customize > Visualization > Views#. Dort können Sie mit icon:button_add_view[] ganz neue Tabellenansichten erzeugen oder wiederum mit icon:icon_clone[] bestehende klonen und anpassen:

image::views_edit_views.png[alt="Ansicht zur Erstellung einer neuen Ansicht."]


=== Erst klonen, dann verändern

Da die mitgelieferten Tabellenansichten Teil der Software sind und somit nicht verändert werden können, kennt {CMK} das Konzept des _Klonens_.
Beim ersten Anpassen einer Tabellenansicht wird automatisch eine Kopie der Tabellenansicht für Sie erzeugt.
Diese Kopie ist dabei Ihrem Benutzerprofil zugeordnet.

Die Kopie können Sie dann so anpassen, wie Sie es möchten.
Die ursprüngliche Tabellenansicht bleibt erhalten, wird aber _verschattet_ -- also durch Ihre Kopie verdeckt.
Sie können später einfach zur Standardansicht zurückkehren, indem Sie Ihren Klon löschen (das geht dann in der Tabelle der Ansichten wie erwartet mit icon:icon_delete[alt="Symbol zum Löschen."]).

Dieses Konzept hat noch einen weiteren Vorteil:
Sie können nämlich bestimmen, ob die Tabellenansicht _für alle Benutzer_ geändert sein soll, oder nur für Sie selbst.
Dies legen Sie in den [.guihint]#General properties# der Tabellenansicht unter [.guihint]#Visibility# mit der Checkbox [.guihint]#Make this view available for other users# fest.
Es überrascht wohl nicht, dass Sie diese Checkbox nur dann setzen können, wenn Sie xref:wato_user#roles[Administratorrechte] haben.
ifdef::onprem[]
Genau genommen gibt es dafür eine eigene Berechtigung mit dem Namen [.guihint]#Publish views.#
Zusätzlich können einzelne Tabellenansichten in den xref:wato_user#roles[Rollendefinitionen] gesperrt werden.
endif::[]

Was ist nun, wenn eine Tabellenansicht von mehreren Benutzern angepasst und freigegeben wurde?
Jeder der Benutzer hat dann nämlich eine eigene Variante der Tabellenansicht.
Welche davon wird für wen sichtbar?
Dies wird durch folgende Regeln bestimmt:

. Wenn ein Benutzer für sich selbst eine Tabellenansicht erzeugt hat, hat diese für ihn immer Vorrang.

. Danach gelten Tabellenansichten, die ein Administrator angepasst und freigegeben hat.
ifdef::onprem[]
Zur Freigabe wird die Berechtigung [.guihint]#Modify builtin views# benötigt.
endif::[]

. Gibt es hier keine, so gelten Tabellenansichten, die ein anderer normaler Benutzer freigegeben hat.
ifdef::onprem[]
Zur Freigabe wird die Berechtigung [.guihint]#Publish views# benötigt.
endif::[]

. Und wenn es hier auch keine gibt, dann wird die ausgelieferte Variante sichtbar.

Wie können Sie nun aber eine _echte Kopie_ einer Tabellenansicht erstellen, also am Ende beide Tabellenansichten sehen -- die mitgelieferte und Ihre Version?
Dies wird über die [.guihint]#Unique ID# in den [.guihint]#General Properties# gesteuert.
Ändern Sie einfach die ID Ihrer Tabellenansicht auf einen anderen Wert.
Damit gilt diese nicht mehr als Klon der mitgelieferten Tabellenansicht, sondern beginnt ein eigenes Leben.

Die ID ist übrigens auch die entscheidende Angabe in der URL, über die Tabellenansichten aufgerufen werden.
Das Schema ist ganz einfach.
So wird z.B. die globale Tabellenansicht mit der ID `allhosts` wie folgt aufgerufen:

`/mysite/check_mk/view.py?view_name=allhosts`

Das Konzept mit dem Klonen und Anpassen und der Sichtbarkeit finden Sie übrigens auch an vielen anderen Stellen von {CMK}, nämlich bei:

* xref:dashboards#[Dashboards]
* xref:reporting#[Berichten]
* xref:graphing#graph_collections[Graphensammlungen]
* xref:graphing#custom_graphs[benutzerdefinierten Graphen]
* xref:user_interface#bookmarks[Lesezeichenlisten]


=== Integration einer Tabellenansicht in die Navigation

Wie und ob eine Tabellenansicht im [.guihint]#Monitor#-Menü der Navigationsleiste sowie dem Snapin [.guihint]#Views# angezeigt wird,
legen folgende Eigenschaften unter [.guihint]#General properties# fest:

image::views_edit_view_general_properties.png[alt="Allgemeine Eigenschaften der Ansicht."]

* [.guihint]#Title:# Dies wird der Name des Eintrags.
* [.guihint]#Topic in 'Monitor menu':# Unter diesem Thema wird die Tabellenansicht einsortiert. Sie können auch eigene Themen definieren.
* [.guihint]#Sort index:# Entscheidet, wie weit oben die Tabellenansicht im Menü erscheint.
* [.guihint]#Visibility:# Damit können Sie den Eintrag unterdrücken und/oder für andere Benutzer freigeben.


=== Grundlegendes Layout

Der nächste Kasten [.guihint]#View Properties# bestimmt das generelle Aussehen der Tabellenansicht:

image::views_edit_view_view_properties.png[alt="Spezifische Eigenschaften der Ansicht."]

Die Einstellung [.guihint]#Number of Columns# bestimmt die Anzahl der Spalten, [.guihint]#Automatic page reload# das Aktualisierungsintervall
-- beide Werte können in der Tabellenansicht selbst mit [.guihint]#Display > Modify display options# noch verändert werden.

Unter [.guihint]#Basic Layout# gibt es verschiedene Arten, wie die Daten in Tabellen dargestellt werden.
Die meisten Tabellenansichten verwenden [.guihint]#Table# -- eine normale Tabelle, die nach Spalten sortierbar ist
-- oder [.guihint]#Single dataset# -- welches die Legende links hat und meist für einzelne Datensätze verwendet wird.
Sie können [.guihint]#Single dataset# aber auch für Tabellenansichten mit mehr als einem Objekt verwenden.
Die Tabellenansicht [.guihint]#All hosts# sieht nach einer Umstellung auf [.guihint]#Single dataset# etwa so aus:

image::views_layout_single_dataset.png[alt="Ergebnis der geänderten Ansicht."]


[#columns]
=== Spalten

Der Kasten [.guihint]#Columns# legt fest, welche Spalten Sie sehen.
Die mögliche Auswahl von Spalten hängt von der gewählten Datenquelle ab.
Die meisten Spalten finden Sie bei den Services, denn hier sind natürlich auch alle Informationen über den jeweiligen Host verfügbar.
Die Liste kann schon recht lang werden und wenn Sie nicht sicher sind, welche Spalte die richtige ist, hilft nur eines: Ausprobieren.

image::views_edit_view_columns.png[alt="Eigenschaften für die Spalten der Ansicht."]

Je nach gewählter Spalte kann es dafür spezifische Optionen geben.
Mit der Spalte [.guihint]#Hosts: Host name# ist es zum Beispiel möglich, den Host-Namen über die Option [.guihint]#Coloring# entsprechend seines Zustands farblich zu hinterlegen.

Das Feld [.guihint]#Link# bietet eine Auswahl von allen Tabellenansichten und Dashboards.
Ist hier eine Tabellenansicht ausgewählt, dann ist die jeweilige Zelle dieser Spalte _anklickbar_ und bringt den Benutzer zur gewählten Tabellenansicht.
Wirklich sinnvoll ist das natürlich nur, wenn die Zielansicht einen Kontext hat.
Bestes Beispiel ist die Tabellenansicht [.guihint]#All hosts#.
Die Spalte [.guihint]#Host# ist hier anklickbar und bringt den Benutzer dann zu [.guihint]#Services of Host# -- von diesem Host.
Alternativ können hier auch Dashboards angegeben werden, die freilich keinen Kontext benötigen.

Unter [.guihint]#Tooltip# werden Sie wiederum die Liste aller Spalten finden.
So können Sie eine weitere Information zu dem Host oder Service einblenden, sobald der Benutzer mit der Maus über die jeweilige Zelle fährt (wie im folgenden Beispiel die IP-Adresse):

image::views_hover_address.png[alt="Ergebnis der geänderten Ansicht mit einem Tooltipp."]


[#joined_columns]
=== Information über Services in einer Host-Ansicht

Stellen Sie sich vor, Sie möchten gerne Informationen zu bestimmten Services in einer Tabelle von Hosts anzeigen.
Das folgende ist ein sehr schönes Beispiel für so etwas:
Zu jedem Host werden die aktuelle Uptime, die CPU-Last, die Speichernutzung und die Ausführungszeit des {CMK}-Agenten ausgegeben:

image::views_joined_columns_example.png[alt="Host-Ansicht mit Perf-O-Metern für die Services."]

Hier wurde eine Tabelle von Hosts erstellt, in der für jeden Host die *Service-Spalte* [.guihint]#Perf-O-Meter# von je vier verschiedenen Services angezeigt wird.
Man sieht auch, dass bei einem der drei Hosts die Services [.guihint]#CPU, Memory# und [.guihint]#Uptime# nicht existieren und die Spalten dort konsequenterweise leer sind.

Um eine Konfiguration zu dieser Tabellenansicht umzusetzen, fügen Sie in der Ansicht Spalten vom Typ [.guihint]#Joined column# hinzu.
Hier erscheinen dann unter [.guihint]#Column# die Spalten für Services, von denen Sie für das Beispiel [.guihint]#Service Perf-O-Meter# auswählen.
Mit dem Eintrag [.guihint]#Title# weiter unten bestimmen Sie dann bei Bedarf die Überschrift der Spalte, wenn die automatische nicht passen sollte.

Unter [.guihint]#of Service# wählen Sie zunächst entweder [.guihint]#Explicit match# oder [.guihint]#Regular expression match# aus.
Bei Ersterem tragen Sie anschließend den *exakten* Namen inklusive der Groß- und Kleinschreibung ein.
Dadurch wird der korrekte Service zu dem Host bestimmt.

image::views_edit_view_columns_2.png[alt="Eigenschaften einer 'Joined column' mit expliziter Angabe des Servicse."]

Wenn Sie nicht genau wissen, wie der Service heißt oder er auf jedem Host ein wenig anders ist, geben Sie einen regulären Ausdruck an, der pro Host auf exakt *einen* Service matcht.
Das ist vor allem dann nützlich, wenn Sie eine Gruppe von Hosts betrachten wollen, bei denen es eine vergleichbare Gruppe an Services gibt, von denen jeweils immer nur einer auf einem Host vorkommen kann.
In dem nachfolgenden Beispiel ist das die [.guihint]#CPU load# oder die [.guihint]#Processor queue,# welche entweder nur auf Linux- oder Windows-Systemen vorkommen kann.

image::views_edit_view_columns_3.png[alt="Eigenschaften einer 'Joined column' mit regulärem Ausdruck für den Service."]

Es gibt übrigens nichts zu befürchten, sollte ein regulärer Ausdruck doch einmal auf mehrere Services zutreffen.
In einem solchen Fall wird immer der erste Treffer in der Spalte angezeigt.

In beiden Varianten ist so eine Darstellung natürlich nur dann nützlich, wenn die Tabellenansicht eine Liste von ähnlichen Hosts anzeigt, welche auch alle über die gewählten Services verfügen oder sich ähnelnde Services haben.
Das ist auch der Grund, warum {CMK} nur wenige solcher Ansichten mit ausliefert:
Welche Spalten hier sinnvoll sind, hängt absolut von der Art der gewählten Hosts ab.
Bei Linux-Servern interessieren sicherlich völlig andere Informationen als z.B. bei USVs.


=== Sortierung

Die Sortierung einer Tabellenansicht konfigurieren Sie im vierten Kasten.
Es handelt sich dabei nur um die voreingestellte Sortierung:
Der Benutzer kann, wie oben beschrieben, über einen Klick auf die Spaltentitel die Sortierung für sich anpassen.
In der Konfiguration der Tabellenansicht haben Sie aber mehr Möglichkeiten:
Sie können eine _mehrstufige_ Sortierung einstellen, z.B. zuerst nach dem Service-Zustand, und bei gleichem Zustand nach dem Namen des Services.
Die so eingestellte Reihenfolge bleibt auch als nachrangige Sortierung erhalten, wenn der Benutzer nach einer bestimmten Spalte umsortiert.

image::views_edit_view_sorting.png[alt="Eigenschaften zur Sortierung der Ansicht."]


=== Gruppierung

Durch Gruppierung zerteilen Sie eine Tabelle in mehrere Abschnitte -- wobei jeder Abschnitt Daten anzeigt, die irgendwie zusammengehören.
Ein gutes Beispiel ist die Tabellenansicht [.guihint]#Service problems#, welche Sie bequem über das [.guihint]#Monitor#-Menü erreichen.

Hier sehen Sie diese Tabelle gruppiert nach dem Service-Zustand ([.guihint]#State#): zuerst alle {CRIT}, dann {UNKNOWN}, dann {WARN} -- jeweils mit einem eigenen Gruppentitel:

image::views_edit_view_grouping.png[alt="Gruppierte Ansicht."]

Die Gruppierung in einer Tabellenansicht konfigurieren Sie analog zu den Spalten.
Legen Sie einfach fest, nach welchen Spalten gruppiert werden soll.
Meist ist das nur eine einzige, aber es können auch mehrere sein.
Alle Datensätze mit dem gleichen Wert für alle gewählten Spalten werden dann in einer Gruppe angezeigt.
Und die Spalteninformation wird jeweils als Gruppentitel anzeigt.

Es ist wichtig, dass Sie die Datensätze auch vorrangig nach der gewählten Gruppeneigenschaft *sortieren!*
Andernfalls kann es sein, dass die gleiche Gruppe mehrfach auftaucht (in Einzelfällen kann dies sogar gewünscht sein).

[TIP]
====
Ein Umsortieren nach einer Spalte durch den Benutzer hat keinen Einfluss auf die Gruppierung:
In diesem Fall wird nur die Reihenfolge der Gruppen bestimmt und die Datensätze werden innerhalb der Gruppen sortiert.
Die Gruppen selbst bleiben erhalten.
====


[#filter_context]
=== Filter, Kontext und Suche

Ein wichtiger Aspekt von Tabellenansichten ist die _Selektion_ der Daten.
Welche Hosts oder Services sollen in der Tabelle angezeigt werden?
{CMK} verwendet hierfür das Konzept der *Filter.*
Hier sind ein paar Beispiele für Host-Filter:

image::views_filter.png[alt="Beispiele für Host-Filter."]

Jeder Filter kann vom Benutzer mit Suchbegriffen oder anderen Kriterien gefüllt werden und reduziert dann die Liste der Ergebnisse auf diejenigen Datensätze, die die Kriterien erfüllen.
Die Filter werden dabei UND-verknüpft.
Die Filterkriterien, die bei einer Tabellenansicht dann tatsächlich zum Einsatz kommen, werden aus drei Quellen zusammengestellt:

. Filter, die direkt in der Tabellenansicht hinterlegt und mit Kriterien gefüllt sind.
. Filter, die der Benutzer interaktiv in der Tabellenansicht mit icon:icon_filter[alt="Symbol eines Filters."] gesetzt hat.
. Filter, die per Variablen über die URL gesetzt werden.

Die Filter, die Sie beim Editieren einer Tabellenansicht im Kasten [.guihint]#Context / Search Filters# zusammenstellen, haben dabei zwei Funktionen.
Zum einen legen Sie so fest, welche Filter dem Benutzer beim Klick auf icon:icon_filter[alt="Symbol eines Filters."] angeboten werden.
Zum anderen können Sie Filter bereits mit Kriterien vorbelegen und so die in der Tabellenansicht gezeigten Daten einschränken (Punkt 1 von oben).

Falls Sie eine Tabellenansicht mit *Kontext* anlegen oder editieren, so tritt anstelle der Filter des entsprechenden Objekts nur ein optionales Eingabefeld.
In diesem gilt dann immer ein _exakter_ Vergleich (Groß-/Kleinschreibung beachten).
Nehmen wir als Beispiel die Tabellenansicht `host`, welche alle Services eines bestimmten Hosts anzeigt.
Der Host-Name wird der Tabellenansicht über einen Kontext mit auf den Weg gegeben.
Sie können sich aber eine Tabellenansicht bauen, welche den gezeigten Host quasi *hart kodiert* direkt in der Tabellenansicht festlegt:

image::views_edit_view_context_filter.png[alt="Eigenschaften zum Filtern der Ansicht."]

Damit können Sie diese Tabellenansicht wieder ohne Kontext aufrufen und auf Wunsch auch problemlos in das Snapin [.guihint]#Views# einbinden.


=== Spezielle Suchansichten

Die mitgelieferten Tabellenansichten [.guihint]#Host search# und [.guihint]#Service search# (und auch andere) verhalten sich im Bezug auf die Filter auf eine spezielle Art:
Wenn Sie so eine Tabellenansicht anwählen, so startet diese mit einem geöffnetem Filter-Formular und zeigt erst dann Hosts oder Services an, wenn dieses abgeschickt wurde.

Warum?
Es wäre einfach sehr unpraktisch, wenn Sie erst auf [.guihint]#All services# gehen müssten -- dann warten bis viele tausend Services dargestellt würden --
und erst dann durch eine Sucheingabe das Ergebnis filtern könnten.
Dieses Verhalten legt die Option [.guihint]#Show data only on search# fest:

image::views_edit_view_view_properties_show_data.png[alt="Die Option 'Show data only on search'."]


[#new]
== Neue Tabellenansichten erstellen

Das Erzeugen einer neuen Tabellenansicht mit icon:button_add_view[] geht im Prinzip genauso wie das Editieren einer bestehenden Tabellenansicht -- mit einem kleinen Unterschied:
Sie müssen vorher noch eine *Datenquelle* und einen *spezifischen Objekttyp* auswählen.


[#datasource]
=== Datenquelle

image::views_create_view_1.png[alt="Auswahl einer Datenquelle."]

Die Datenquelle ist das, was man in Datenbanken vielleicht als Tabelle oder Datenbank-View bezeichnen würde.
{CMK} verwendet zwar keine SQL-Datenbank, ist intern aber ähnlich aufgebaut.
In den meisten Fällen liegen Sie mit [.guihint]#All services# oder [.guihint]#All hosts# richtig.
Es gibt aber einige spezielle Datenquellen, die hier kurz aufgelistet werden sollen:

[cols=2]
|===
|Datenquelle |Bedeutung

|Host- und Service-Gruppen, diverse |siehe xref:host_service_groups[unten]

|[.guihint]#BI#, diverse |xref:bi#[Business Intelligence]

|[.guihint]#Inventory#, diverse |xref:inventory#[HW-/SW-Inventur]

ifdef::onprem[]
|[.guihint]#Alert statistics# |xref:livestatus#retrieving_statistics[Statusstatistiken]

|[.guihint]#Event Console#, Host- und Service-Events |xref:ec#[Event Console]

|[.guihint]#The Logfile# |xref:livestatus#logs[Livestatus-Daten]
endif::[]
|===


[#host_service_groups]
==== Host- und Service-Gruppen

Die Datenquellen [.guihint]#Host groups# und [.guihint]#Service groups# liefern je Zeile die Informationen über die Gruppe selbst
-- Filter für einzelne Hosts oder Services gibt es entsprechend nicht.
Ein Beispiel für diese Datenquelle ist die Standardansicht [.guihint]#Host groups#.
ifdef::onprem[]
In verteilten Umgebungen erledigen die Datenquellen [.guihint]#Host groups, merged# und [.guihint]#Service groups, merged# genau das Gleiche.
endif::[]

image::views_hostgroups_summary.png[alt="Ansicht für Host-Gruppen."]

Wenn Sie hingegen Informationen zu einzelnen Hosts wünschen, lediglich gruppiert nach Host-Gruppen,
können Sie etwa die Standardansicht [.guihint]#All hosts# in den Einstellungen im Kasten [.guihint]#Grouping# um die Option [.guihint]#Hosts: Host groups the host is member of# ergänzen.
Da Hosts mehreren Gruppen zugeordnet sein können, finden Sie in der Tabellenansicht dann einen einzelnen Bereich für jede *Host-Gruppenkombination,* die für mindestens einen Host gilt.

image::views_hostgroups.png[alt="Ansicht mit Gruppierung nach Host-Gruppen."]

Auf dieselbe Weise können Sie auch mit Services und Service-Gruppen verfahren.

Je nach ausgewählter Datenquelle stehen Ihnen unterschiedliche Spalten zum Aufbau der Tabellenansicht zur Verfügung.


=== Objekttyp: Global oder mit Kontext

image::views_create_view_2.png[alt="Auswahl eines spezifischen Objekttyps."]

Hier entscheidet sich, ob Ihre neue Tabellenansicht einen Kontext haben oder ob es eine globale Tabellenansicht werden soll.
Welche Auswahlmöglichkeiten Sie haben, hängt von der gewählten Datenquelle ab.
Der mit Abstand häufigste Kontext ist Host.
Die Abbildung von oben erscheint nach der Auswahl der Datenquelle [.guihint]#All services.#

Durch das Aktivieren von [.guihint]#Show information of a single Host# legen Sie fest, dass die neue Tabellenansicht genau einen Host beschreibt.
So haben Sie die Grundlage dafür geschaffen, dass die Tabellenansicht nicht global, sondern verlinkt sichtbar wird:

* Bei einer Host-Ansicht mit einem Kontext
* Als Verknüpfung in einer Spalte (siehe oben, z.B. Klick auf Host-Name in einer Tabellenansicht)

Bei dem Kontexttyp Service gibt es zwei Möglichkeiten:
Wenn Sie nur [.guihint]#Show information of a single Service# anwählen, können Sie eine Tabellenansicht bauen, die alle Services mit dem gleichen Namen aber auf _verschiedenen Hosts_ anzeigt.
Wenn es um einen ganz bestimmten Service von einem einzigen Host gehen sollen, dann wählen Sie zusätzlich [.guihint]#Show information of a single Host# aus.


[#joined_inventory_columns]
== Inventurtabellen verknüpfen

{CMK} bietet viele unterschiedliche Daten zu einem Host oder einem Service.
Die meisten davon können Sie mit den Datenquellen [.guihint]#All services# oder [.guihint]#All hosts# darstellen.
Die xref:inventory#[HW-/SW-Inventur] bietet darüber hinaus weitere xref:inventory#table[Tabellen] (als Datenquellen), die Sie ebenso in eigenen Ansichten anzeigen und individuell strukturieren können.
Sie können solchen Ansichten auch Spalten aus anderen Tabellen hinzufügen, sofern diese eine gemeinsame Spalte haben.

*Wichtig:* Die Anzahl der Zeilen der finalen Ansicht entspricht der Anzahl der Zeilen der zugrundeliegenden Datenquelle Ihrer Ansicht.
Verknüpfte Tabellen fügen lediglich ausgewählte Spalten hinzu.

In dem folgenden Beispiel werden Sie einmal eine sehr kompakte Ansicht erstellen, in der zwei HW-/SW-Inventurtabellen miteinander verknüpft werden.
Erstellen Sie zum Anfang xref:new[eine neue Ansicht] und wählen Sie als grundlegende xref:datasource[Datenquelle] die gewünschte Inventurtabelle aus.
Für das Beispiel suchen Sie nach [.guihint]#Inventory table: Checkmk ➤ Checkmk sites# und bestätigen anschließend mit icon:button_continue[] [.guihint]#Continue#:

image::views_create_view_3.png[alt="Auswahl der Datenquelle 'Checkmk sites'."]

Die darauf folgende Seite können Sie überspringen, da es nicht nötig ist, die Datenquelle auf einen einzelnen Host oder eine einzelne Instanz einzuschränken.
Der nächste Schritt erfolgt also direkt auf der Hauptseite der Konfiguration, wo Sie zunächst die [.guihint]#Unique ID# und einen [.guihint]#Title# eintragen.

Im Kasten [.guihint]#Macros for joining service data or inventory tables# kommt dann die erste spezifische Konfiguration, um später andere Datenquellen in die Ansicht einzubinden.
Zu diesem Zweck werden Indikatoren benötigt, über die man dann später die richtigen Zeilen in den weiteren Datenquellen identifiziert.
Legen Sie also hier wie in dem nachfolgenden Beispiel die Makros für die Spalten [.guihint]#Version# und [.guihint]#Site# an:

image::views_create_view_4.png[alt="Dialog zum Anlegen von Makros."]

Diese Makros können Sie nun in speziellen [.guihint]#Columns# verwenden.
Neben den xref:columns[regulären Spalten,] die bereits in der Anpassung von Ansichten verwendet wurden, stehen jetzt sowohl die ebenfalls vorher beschriebenen Spalten der xref:joined_columns[Service-Datenquelle] ([.guihint]#Joined columns#) als auch die der [.guihint]#Joined inventory columns# zur Verfügung.

Die ersten beiden Spalten nutzen Standarddaten aus der Datenquelle.
Da Daten aus der HW-/SW-Inventur immer zu einem bestimmten Host und einer bestimmten Instanz gehören, stehen Ihnen diese Tabellen ebenfalls zur Verfügung, wenn Sie eine solche Datenquelle ausgewählt haben.

image::views_create_view_5.png[alt="Dialog zur Auswahl der Spalten."]

Anschließend können Sie die definierten Makros nicht nur in den [.guihint]#Joined inventory columns# verwenden, sondern auch in den [.guihint]#Joined columns,#
um die Daten von bestimmten Services anzuzeigen.
Das ermöglicht die Kombination unterschiedlichster Quellen -- in diesem Fall, das Perf-O-Meter des dazugehörigen Performance-Service einer Instanz anzuzeigen.

Die Makros können Sie übrigens genauso auch bei der Definition von regulären Ausdrücken verwenden.

image::views_create_view_6.png[alt="Auswahl einer 'Joined column' unter Verwendung eines Makros."]

Daten aus anderen HW-/SW-Inventurtabellen anzuzeigen funktioniert ganz ähnlich.
Lediglich die zu verwendende Tabelle ist vorher auszuwählen.
In dem nachfolgenden Beispiel verwenden Sie die Tabelle [.guihint]#Checkmk ➤ Checkmk versions,# wodurch die Drop-down-Liste [.guihint]#Display the column# automatisch auf eine sinnvolle Auswahl eingeschränkt wird.

Wie {CMK} die richtige Zeile in der Tabelle findet, von der die Spalte angezeigt werden soll, bestimmen Sie danach.
Fügen Sie dafür mit dem Knopf [.guihint]#Add new match criteria# ein Kriterium in Form einer Spalte hinzu, über das {CMK} später die passende Zeile bestimmen kann.
In dem obigen Beispiel ist das die [.gui]#Version.#
Denn diese ist in der Tabelle einzigartig und kann nur einmal vorkommen.
Das bedeutet umgekehrt auch, dass Sie zwar beliebige Tabellen der HW-/SW-Inventur miteinander verknüpfen können, Sie dabei aber auch sicherstellen müssen, dass die beiden Tabellen immer eine gemeinsame Spalte haben und diese Spalte auch immer einzigartige Einträge enthält.
In dem obigen Beispiel wäre die Spalte [.guihint]#Sites# also kein geeignetes Kriterium, da es mehrere Editionen mit derselben Anzahl an Instanzen geben könnte.

image::views_create_view_7.png[alt="Auswahl einer 'Joined inventory column' unter Verwendung eines Makros."]

Selbstverständlich können Sie bei Bedarf auch bei einer [.guihint]#Joined inventory column# den Titel der Spalte anpassen, wenn der automatische nicht passen sollte.
Nachdem alle Einstellungen vorgenommen wurden, speichern Sie mit icon:button_save_and_go_to_view[] [.guihint]#Save & go to view# die neue Ansicht ab und werden direkt zu dem Ergebnis geleitet.
Je nachdem, wie viele Instanzen bei Ihnen überwacht werden, wird auch entsprechend für jede eine Zeile in der Ansicht eingefügt:

image::views_create_view_8.png[alt="Fertige Ansicht inklusive Spalten aus anderen Quellen."]

Wie Sie hier sehen können, gibt es für jede Spalte immer einen Standardtitel, wenn dieser nicht von Ihnen vorgegeben wird.
In der dritten Spalte zu dem [.guihint]#Perf-O-Meter# wurde der Titel nicht vergeben, so dass von {CMK} der verwendete reguläre Ausdruck als Titel herangezogen wurde.
Sie können das jederzeit ändern und wie bei der Spalte zu der [.guihint]#Edition# anpassen.


[#matrix]
== Die Matrix

Wenn Sie in den [.guihint]#View Properties# als [.guihint]#Basic Layout#  bei einer Ihrer Tabellenansichten [.guihint]#Matrix# einstellen,
werden Sie wahrscheinlich erstmal seltsame Dinge erleben und sich fragen, was das Ganze soll.
Die Matrix ist sicher nicht auf den ersten Blick einleuchtend, aber Sie können damit tolle Dinge machen.

In den ausgelieferten Tabellenansichten gibt es z.B. [.guihint]#Search performance data,# die dieses Layout verwendet.
Sie finden diese Tabellenansicht im Monitor-Menü unter [.guihint]#Monitor > History > Search performance data# und auch in [.guihint]#Customize > Visualization > Views.#
In der Liste der Views müssen Sie eventuell zuvor die Begrenzung auf die Anzeige von maximal 100 Zeilen aufheben.

Folgende Abbildung zeigt eine Suche nach dem Serviceausdruck `CPU|^memory|Filesystem /opt/omd/sites/mysite`:

image::views_matrix_filter_service.png[alt="Filter für die Service-Suche.",width=55%,align=center]

Das Ergebnis ist eine hübsche Tabelle der Hosts, in denen die Metriken all dieser Services gegenübergestellt sind.
Nicht alle Hosts haben die gleichen Services, so dass bei einigen Hosts dann die entsprechenden Zellen einfach leer bleiben:

image::views_matrix_view_1.png[alt="Ergebnis der Service-Suche in einer Matrixansicht."]

Das Ganze sieht jetzt erstmal sehr ähnlich aus wie die weiter oben beschriebene xref:joined_columns[Information über Services in einer Host-Ansicht.]
Es gibt aber ein paar wesentliche Unterschiede:

. Die Liste der Services ist dynamisch und nicht fest konfiguriert.
. Die Hosts sind hier die Spalten  --  nicht die Zeilen.

Sie können mit der Matrix noch viel mehr anstellen.
Wenn Sie in die Definition der Tabellenansicht gucken, können Sie sehen, wie diese konstruiert ist:

* Als [.guihint]#Basic Layout# ist [.guihint]#Matrix# eingetragen.
* Bei [.guihint]#Grouping# ist als einzige Spalte der Host-Name ([.guihint]#Hosts: Host name#) eingetragen.
* Bei [.guihint]#Columns# sind [.guihint]#Service name# und [.guihint]#Service Perf-O-Meter# eingetragen.

Die Regel für das Matrix-Layout ist so:

* Die unter *Grouping festgelegten Spalten* werden als Überschriften für die Spalten verwendet.
* Die *erste normale Spalte* bildet die linke Spalte mit der Beschriftung der Zeilen.
* Alle *weiteren normalen Spalten* werden in den Zellen angezeigt.

Wenn Sie z.B. mehr Informationen über den Host anzeigen möchten, fügen Sie einfach weitere Spalten im Kasten [.guihint]#Grouping# hinzu.
So sieht z.B. die Tabelle von oben aus, wenn Sie die Spalten
[.guihint]#Host icons# und [.guihint]#Folder - just folder name# hinzufügen:

image::views_matrix_view_2.png[alt="Matrixansicht mit zusätzlichen Zeilen."]

Weitere *normale Spalten* landen dann direkt in den Zellen. Folgendes Beispiel (gekürzt) zeigt
die Matrix mit der zusätzlichen Spalte [.guihint]#Output of check plugin#:

image::views_matrix_view_3.png[alt="Matrixansicht mit zusätzlichen Informationen in den Zellen."]


=== Erkennen von Ausreißern

Warum sind eigentlich manche Zellen farbig hinterlegt?
Nun -- hier werden Sie hingewiesen auf Werte, die sich *abheben von der Mehrheit.*
Das ist wohl bei Messdaten nicht so sinnvoll.
Aber es gibt Anwender, die mit einer speziell konstruierten Matrixansicht auf einen Blick feststellen können, ob z.B. bei gewissen Hosts oder Services eine falsche Kontaktgruppe eingetragen ist.

image::views_matrix_view_4.png[alt="Matrixansicht mit farblicher Kennzeichnung von Zellen mit abweichendem Inhalt."]


[#alarm_sounds]
== Alarmtöne

Eine Tabellenansicht kann über den Browser Alarmtöne (_alarm sounds_) abspielen, wenn sich in der Tabelle mindestens ein Problem befindet (also ein Host der nicht {UP} oder ein Service
der nicht {OK} ist).
Diese primitive Art der Alarmierung ist z.B. interessant für Leitstände, wo die Liste der Probleme ständig auf einem Schirm sichtbar ist, aber der Operator nicht ständig auf diesen starren möchte.

Die Alarmtöne sind per Default ausgeschaltet.
Über den globalen Schalter [.guihint]#Setup > General > Global settings > User interface > Sounds in views# können Sie diese einschalten.
Wie (fast) immer hilft hier die Suche im [.guihint]#Setup#-Menü:

image::views_global_settings_sound.png[alt="Globale Einstellung zum Einschalten von Alarmtönen in Ansichten."]

Alarmtöne werden aber nicht in allen Tabellenansichten abgespielt, sondern nur, wo dies in den [.guihint]#View Properties# aktiviert ist:

image::view_properties_sounds.png[alt="Aktivierung von Alarmtönen in einer Ansicht."]


// TK: Commented out as this feature depends on the Enable login via GET requests global setting that is disabled by default due to security reasons since 2.2.0
////
[#embed_views]
==  Ansichten in externe Websites einbetten

Da jede Tabellenansicht über eine URL erreichbar ist, können Sie diese auch in andere Webseiten einbetten -- z.B. über einen `&lt;iframe&gt;`.
Etliche Elemente der Tabellenansicht ergeben allerdings in so einem Kontext keinen Sinn oder sind sogar störend.
In so einem Fall können Sie an die URL die Variable `display_options=` anhängen, über die Sie genau steuern können,
welche Bestandteile der Tabellenansicht im HTML-Code *nicht* generiert werden sollen.

*Wichtig:* Auch die Navigation von {CMK} ist beim Einbetten meist eher unerwünscht.
Bevor Sie also in einer Tabellenansicht manuell Optionen setzen, lassen Sie die Seite ohne Navigation und Seitenleiste anzeigen indem Sie [.guihint]#Display > Show page navigation# ausschalten.

Jeder Bestandteil wird durch einen Buchstaben kodiert und kann entsprechend ausgeschlossen werden.

Folgende Buchstaben sind definiert:

[cols="10,~"]
|===
|Option |Wirkung

|`t` |Titelzeile (mit Seitentitel, Breadcrumb-Pfad, Symbol zum Countdown der Seitenaktualisierung), Menüleiste und Aktionsleiste werden entfernt.
|`b` |Menüeinträge und Aktionsknöpfe werden entfernt, die zu anderen Tabellenansichten verlinken.
|`f` |Menüeintrag [.guihint]#Display > Filter# und der zugehörige Aktionsknopf icon:icon_filter[alt="Symbol eines Filters."] zum Öffnen der Filterleiste werden entfernt.
|`c` |Menü [.guihint]#Commands# und zugehörige Aktionsknöpfe werden entfernt.
|`o` |Die Optionen [.guihint]#Entries per row# und [.guihint]#Refresh interval# werden entfernt, sonst einzublenden mit [.guihint]#Display > Modify display options#.
|`d` |Menüeintrag [.guihint]#Display > Modify display options# wird entfernt.
|`e` |Menüeintrag [.guihint]#Display > Clone builtin view# wird entfernt.
|`r` |Symbol zum Countdown der Seitenaktualisierung in der Titelzeile und der JavaScript-Code für die automatische Aktualisierung werden entfernt.
|`s` |Abspielen von xref:views#alarm_sounds[Alarmtönen] bei den Service-Zuständen {WARN} und {CRIT} wird unterdrückt.
|`i` |Links auf andere Tabellenansichten werden entfernt, z.B. in einer Service-Liste die Links in der Spalte [.guihint]#Service#.
|`m` |Das Ziel von Links ist standardmäßig der HTML-Frame `main` -- mit dieser Option werden Links in neuen Tabs geöffnet.
|`l` |Links in Spaltentiteln werden entfernt.
ifdef::onprem[]
|`w` |Limitierung und Livestatus-Fehlermeldungen.
endif::[]
|===

Wenn Sie also die z.B. alle Bedienelemente, Knöpfe und Links abschalten und nur die eigentliche Tabelle darstellen möchten, so sieht ein Link auf die Tabellenansicht `allhosts` so aus:

`/myserver/mysite/check_mk/view.py?view_name=allhosts&display_options=til`
////

==  Symbole und Aktionen hinzufügen

In Tabellenansichten von Hosts und Services sehen Sie auch eine Spalte für Symbole (_icons_) und darin das icon:icon_menu[alt="Symbol des Aktionsmenüs in der Tabellenansicht."] Aktionsmenü, aus dem Sie Host- beziehungsweise Service-Aktionen auswählen können.
ifdef::onprem[]
Sie dürfen Tabellenansichten aber auch um eigene Symbole erweitern.
endif::[]
ifdef::saas[]
Sie dürfen Tabellenansichten aber auch um Symbole erweitern, die Sie aus den von {CMK} mitgelieferten Symbolen auswählen können.
endif::[]
Diese können wahlweise schlicht zur Visualisierung genutzt oder mit eigenen Aktionen belegt werden.

So ließen sich zum Beispiel Hosts, die über eine grafische Weboberfläche verfügen, über solch ein individuelles Symbol schnell identifizieren und über einen Link auch direkt ansteuern.

Das Prozedere für Symbole und Aktionen gliedert sich in die folgenden Schritte:

ifdef::onprem[]
. Symbole hochladen.
endif::[]
. Symbole/Aktionen definieren.
. Symbole Hosts/Services zuordnen.

ifdef::onprem[]
Starten Sie über [.guihint]#Setup > General > Custom Icons# und laden Sie eine lokale Datei mit einer maximalen Größe von 80 x 80 Pixeln hoch.
Damit ist das Icon im System, findet aber noch keinerlei Verwendung.

image::views_manage_icons_upload.png[alt="Dialog zur Auswahl und zum Hochladen eines eigenen Symbols."]
endif::[]

ifdef::onprem[]
Nun müssen Sie das Icon noch 
endif::[]
ifdef::saas[]
Sie müssen das Icon 
endif::[]
als über xref:glossar#rule[Regeln] ansprechbares Objekt und optional eine zugehörige Aktion definieren.
Die Einstellungen finden Sie unter [.guihint]#Setup > General > Global settings > User interface > Custom icons and actions.#
Erstellen Sie hier über [.guihint]#Add new element# einen neuen Eintrag und legen Sie [.guihint]#ID#, [.guihint]#Icon# und einen [.guihint]#Title# fest;
der Titel wird übrigens später per On-Mouse-Over-Effekt als Tooltipp direkt am Symbol angezeigt und ist für die Benutzer damit sehr hilfreich.

image::views_global_settings_custom_icons_and_actions.png[alt="Eigenschaften für eigene Symbole."]

Interessant wird es nun beim Punkt [.guihint]#Action#:
Aktion ist hier gleichzusetzen mit einer URL und für diese dürfen Sie einige Variablen wie `$HOSTNAME$` oder `$SERVICEDESC$` (Service-Beschreibung) nutzen
-- weitere Hinweise bekommen Sie über die Inline-Hilfe.
Eine gültige Aktion wäre beispielsweise:

`view.py?host=$HOSTNAME$&site=mysite&view_name=host`

Diese Aktion ruft schlicht die Standard-Host-Ansicht für den jeweiligen Host auf der Instanz `mysite` auf.

Über ein Häkchen bei [.guihint]#Show in column# können Sie das Symbol dann als eigenständiges Bildchen neben icon:icon_menu[alt="Symbol des Aktionsmenüs in der Tabellenansicht."] anzeigen lassen,
andernfalls landet Ihre Aktion im zugehörigen Aktionsmenü.

Im letzten Schritt bestimmen Sie nun, bei welchen Hosts oder Services das neue Symbol angezeigt werden soll -- und das natürlich über Regeln.
Sie finden die beiden Regelsätze [.guihint]#Custom icons or actions for hosts in status GUI# und [.guihint]#Custom icons or actions for services in status GUI# im [.guihint]#Setup#-Menü unter [.guihint]#Host monitoring rules# und [.guihint]#Service monitoring rules#.
Am schnellsten finden Sie die beiden Regeln mit der Suche im [.guihint]#Setup#-Menü.

Legen Sie eine neue Regel an und setzen Sie darin mindestens zwei Optionen:
Zum einen wählen Sie unter [.guihint]#Custom icons or actions for hosts in status GUI# das just angelegte Symbol:

image::views_custom_icons_or_actions.png[alt="Die Regel für die Nutzung eines eigenen Icons."]

Zum anderen filtern Sie im Kasten [.guihint]#Conditions# wie üblich auf die gewünschten Hosts/Services:

image::views_custom_icons_or_actions_b.png[alt="Bedingungen in der Regel für die Nutzung eines eigenen Icons."]

Speichern und bestätigen Sie anschließend die Änderungen.

In Host- und Service-Ansichten sehen Sie ab sofort bei den gefilterten Hosts und Services Ihr neues Symbol neben oder im Aktionsmenü:

image::views_view_with_custom_icon.png[alt="Host-Ansicht mit dem eigenen Icon."]
